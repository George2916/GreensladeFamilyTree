var azurLoaded=!1,multiMaps=new Array,lastEventTime=0,msActiveForm=null,analyticsCheckout=0;function stripeSetupPaymentForm(t,e){var a={base:{fontSize:"16px",lineHeight:"24px"}},n=($("#postalcode").attr("data-ov"),stripe.elements());cardNumber=n.create("cardNumber",{style:a}),cardNumber.mount("#cardnumber"),n.create("cardCvc",{style:a}).mount("#cvc"),n.create("cardExpiry",{style:a}).mount("#expiration"),n.create("postalCode",{style:a}).mount("#postalcode");var i=parseInt($("#payment-request-button").attr("data-ot")),r=$("#payment-request-button").attr("data-fh"),s=stripe.paymentRequest({country:t,currency:e,requestPayerName:!0,requestPayerEmail:!0,requestPayerPhone:!0,total:{label:r+" Order",amount:i}}),o=n.create("paymentRequestButton",{paymentRequest:s});s.canMakePayment().then(function(t){t?(o.mount("#payment-request-button"),$("#pmttrad").hide()):($("#payment-request-button").hide(),$("#pmttrad").show(),$("#pmtmechsw").hide(),$("#hidetrad").hide(),$("#showtrad").hide())}),s.on("token",function(t){var e=$("#payment-request-button").attr("data-tp");$("#pmtstatus").text("Processing payment - please wait..."),$("#pmtstatus").show();var a=encodeURIComponent($.toJSON(t));if(1==e){axpost("/pax/fcdopmt","sid="+$("#fcrvdn").attr("data-sid")+"&stppmt=1&prb=1&dt="+a,function(e){try{var a=JSON.parse(e);"OK"==a.result?($("#fcfund").html(a.html),t.complete("success")):($("#pmtstatus").html(a.html),$("#pmtstatus").show(),t.complete("fail"))}catch(a){$("#pmtstatus").html("An error occurred while trying to process this payment"),$("#pmtstatus").show(),t.complete("fail"),axpost("/pax/reperr","dt="+encodeURIComponent(e),function(){})}})}else{var n=$("#payment-request-button").closest(".sitestore").attr("id");storepost(n,"ck","step=placeorder&stppmt=1&prb=1&rid="+n+"&dt="+a,function(e){try{var a=JSON.parse(e);"OK"==a.result?($("#"+n).html(a.html),t.complete("success")):($("#pmtstatus").html(a.html),$("#pmtstatus").show(),t.complete("fail"))}catch(a){$("#pmtstatus").html("An error occurred while trying to process this payment"),$("#pmtstatus").show(),t.complete("fail"),axpost("/pax/reperr","dt="+encodeURIComponent(e),function(){})}})}})}function stripeOnSubmitPaymentForm(){return""!=$("#pmttoken").val()||($("#cmdsubmit").prop("disabled",!0),$("#pmtstatus").text("Authorizing..."),$("#pmtstatus").show(),stripe.createToken(cardNumber).then(function(t){t.error?($("#pmtstatus").text(t.error.message),$("#pmtstatus").show(),$("#cmdsubmit").prop("disabled",!1),$("#pmttoken").val("")):($("#pmttoken").val(t.token.id),$("#expmonth").val(t.token.card.exp_month),$("#expyear").val(t.token.card.exp_year),$("#lastfour").val(t.token.card.last4),$("#zip").val(t.token.card.address_zip),$("#cmdsubmit").click())}),!1)}function stripeOnPaymentError(){$("#pmttoken").val("")}function initPmtFormStep1(){$("#fm-step1").submit(function(t){return t.preventDefault(),axpost("/pax/pmtctra",$("#fm-step1").serialize(),function(t){$("#paymentform").html(t)}),!1})}function pcTradForm(t){t?($("#payment-request-button").hide(),$("#pmttrad").show(),$("#showtrad").hide(),$("#hidetrad").show()):($("#payment-request-button").show(),$("#pmttrad").hide(),$("#showtrad").show(),$("#hidetrad").hide())}function pcPmtSetup(t,e,a){$("#pc-mkchg").click(function(){axpost("/pax/pmtctrfs","amt="+$("#pcamt").attr("data-amt")+"&notes="+encodeURIComponent($("#pcnotes").html()),function(t){$("#paymentform").html(t)})}),$("#fmpayment").submit(function(t){return t.preventDefault(),pcOnPayment(),!1});var n={base:{fontSize:"16px",lineHeight:"24px"}},i=($("#postalcode").attr("data-ov"),stripe.elements());cardNumber=i.create("cardNumber",{style:n}),cardNumber.mount("#cardnumber"),i.create("cardCvc",{style:n}).mount("#cvc"),i.create("cardExpiry",{style:n}).mount("#expiration"),i.create("postalCode",{style:n}).mount("#postalcode");parseInt($("#payment-request-button").attr("data-ot"));var r=$("#payment-request-button").attr("data-fh"),s=stripe.paymentRequest({country:a,currency:e,requestPayerName:!0,requestPayerEmail:!0,requestPayerPhone:!0,total:{label:r+" Payment",amount:t}}),o=i.create("paymentRequestButton",{paymentRequest:s});s.canMakePayment().then(function(t){t?(o.mount("#payment-request-button"),$("#pmttrad").hide()):($("#payment-request-button").hide(),$("#pmttrad").show(),$("#hidetrad").hide(),$("#showtrad").hide())}),s.on("token",function(t){$("#payment-request-button").attr("data-tp");$("#pmtstatus").text("Processing payment - please wait..."),$("#pmtstatus").show();var e=encodeURIComponent($.toJSON(t));axpost("/pax/pmtctrsp","amt="+$("#pcamt").attr("data-amt")+"&notes="+encodeURIComponent($("#pcnotes").html())+"&prb=1&pmthst=st&dt="+e,function(e){var a=JSON.parse(e);"OK"==a.result?($("#paymentform").html(a.html),t.complete("success")):($("#pmtstatus").html(a.html),$("#pmtstatus").show(),t.complete("fail"))})})}function pcOnPayment(){return""!=$("#pmttoken").val()||($("#pmtsubmit").prop("disabled",!0),$("#pmtstatus").text("Authorizing..."),$("#pmtstatus").show(),stripe.createToken(cardNumber).then(function(t){t.error?($("#pmtstatus").text(t.error.message),$("#pmtstatus").show(),$("#pmtsubmit").prop("disabled",!1),$("#pmttoken").val("")):($("#pmttoken").val(t.token.id),$("#expmonth").val(t.token.card.exp_month),$("#expyear").val(t.token.card.exp_year),$("#lastfour").val(t.token.card.last4),$("#zip").val(t.token.card.address_zip),axpost("/pax/pmtctrsp","amt="+$("#pcamt").attr("data-amt")+"&notes="+encodeURIComponent($("#pcnotes").html())+"&prb=0&"+$("#fmpayment").serialize(),function(t){var e=JSON.parse(t);"OK"==e.result?$("#paymentform").html(e.html):($("#pmtstatus").html(e.html),$("#pmtstatus").show())}))}),!1)}function initVerticalMenu(t,e){$("#"+t+" .vtmnu-section").click(function(){var t=$(this),e=t.attr("data-target");if(0==$(e).is(".in")){var a=t.closest(".vert-menu");a.find("a.vtmnu-section").each(function(){var n=$(this).parent();e=$(this).attr("data-target"),1==$(e).is(".in")&&$(this)!=a&&0==n.find(t).length&&$(this).click()})}}),e="/"+e,$("#"+t+"-mnu a").each(function(){$(this).attr("href")==e&&($(this).addClass("mnu-selected"),mnuExpandParent($(this)))})}function mnuExpandParent(t){t.closest("ul.subnav").length&&mnuExpandParent(t.closest("ul.subnav").removeClass("collapsed").addClass("collapse in").parent())}function navTileClick(t){if(!$("#site").is(".editmode")){var e=t.attr("data-url");if(t.attr("data-pgid")>0)e=pfx()+t.attr("data-url"),window.location=e;else if(-1==e.indexOf("//")){var a=pfx();""!=a&&-1==e.indexOf(a+"/")&&(e=a+e),""!=e&&(window.location=e)}else""!=(e=t.attr("data-url"))&&window.open(e,"_blank")}}function initMultiStepForm(t){var e=$("#"+t),a=e.find("form");e.find("div.form-group").removeClass("has-error");var n=pfx()+"/pax/customform";a.attr("action",n),e.find(".btn-prev").click(function(t){return t.preventDefault(),fmPriorStep(e),!1}),e.find(".btn-next").click(function(t){return t.preventDefault(),fmNextStep(e),!1}),e.find(".date-field").datetimepicker({pickTime:!1}),e.find(".stepzone").on("click","li",function(){formStep(e,$(this))}),e.find("div.formcontent").click(function(t){t.timeStamp!=lastEventTime&&(lastEventTime=t.timeStamp,setTimeout(function(){computeStepPath(e)},10))}),initCustomFormSubmitHandler(e,a),computeStepPath(e),showStep(e,1,1),fmInitializeDynamicItems(e)}function populateMerchandiseList(t){var e=t.attr("data-prodids"),a=t.attr("data-singlesel");axpost("/pax/fmmrchlist","ids="+e+"&singlesel="+a,function(e){t.find(".fm-mdse-items").html(e),t.find(".fm-mdse-items .merchandiselist li").click(function(){onFormMerchandiseListClick($(this),a)})})}function onFormMerchandiseListClick(t,e){if(1==e){if(t.is(".selected"))return void t.removeClass("selected");t.parent().find(".selected").removeClass("selected"),t.addClass("selected"),t.find(".price").addClass("selected")}else t.is(".selected")?(t.removeClass("selected"),t.find(".price").removeClass("selected")):(t.addClass("selected"),t.find(".price").addClass("selected"))}function formStep(t,e){var a=e.attr("data-idx"),n=t.find("li.active"),i=parseInt(n.attr("data-idx"));if(a!=i)if($("#site").is(".editmode"))showStep(t,a,0);else if(a<i)showStep(t,a,0);else{var r=0;for(r=1;r<a;r++){if(!t.find(".stepzone li[data-idx="+r+"]").is(".msform-hidden"))if(0==validatePanel(t.find(".panelzone .formcontent[data-idx="+r+"]")))return void showStep(t,r,0)}showStep(t,a,0)}}function validateCurrentStep(t){var e=t.find(".stepzone li.active").attr("data-idx");return validatePanel(t.find(".panelzone .formcontent[data-idx="+e+"]"))}function processPaymentForm(t,e){if(0==validatePanel(e.closest(".formcontent")))return!1;switch($("#pmthst").val()){case"st":return processStripeFormPaymentWidget(t,e);case"fa":return processFAFormPaymentWidget(t,e)}}function processStripeFormPaymentWidget(t,e){if(""!=$("#pmttoken").val())return!0;var a=t.find(".btn-next");return a.prop("disabled",!0),$("#pmtstatus").text("Authorizing..."),$("#pmtstatus").show(),stripe.createToken(cardNumber).then(function(e){e.error?($("#pmtstatus").text(e.error.message),$("#pmtstatus").show(),a.prop("disabled",!1),$("#pmttoken").val("")):($("#pmttoken").val(e.token.id),$("#expmonth").val(e.token.card.exp_month),$("#expyear").val(e.token.card.exp_year),$("#lastfour").val(e.token.card.last4),$("#zip").val(e.token.card.address_zip),axpost("/pax/pmtctrsp",t.find("form").serialize(),function(e){var n=JSON.parse(e);"OK"==n.result?submitCustomFormAfterPayment(t,n.pmtid):($("#pmtstatus").html(n.html),$("#pmtstatus").show(),a.prop("disabled",!1),$("#pmttoken").val(""))}))}),!1}function processFAFormPaymentWidget(t,e){return""==$("#pmttoken").val()?($("#pmtstatus").text("Please complete the credit card details first"),$("#pmtstatus").show(),!1):($("#pmtstatus").text("Processing payment - please wait..."),$("#pmtstatus").show(),axpost("/pax/pmtctrsp",t.find("form").serialize(),function(e){var a=JSON.parse(e);"OK"==a.result?submitCustomFormAfterPayment(t,a.pmtid):($("#pmtstatus").html(a.html),$("#pmtstatus").show())}),!1)}function validatePanel(t){var e=!0;return t.find(".form-group").removeClass("has-error"),t.find(".alert:not(.alstatus)").remove(),t.find("input,textarea,select").filter("[required]").each(function(){var a=$(this);if(0==a[0].checkValidity()){var n=a.closest(".form-group");n.addClass("has-error");var i=n.find(".fieldname").attr("data-reqtext");null==i||""==i?i="Please provide a response in the highlighted (red) area below":i+=" (highlighted in red)";var r='<div class="alert alert-warning no-save" role="alert" style="padding:10px;margin:0px 5px">'+i+"</div>";return t.prepend(r),a.focus(),e=!1,!1}}),0!=e&&(t.find(".popdlg[data-type=checkboxes]").each(function(){var a=$(this);if(1==a.attr("data-reqd")&&0==a.find("input:checked").length){a.addClass("has-error");var n=a.find(".fieldname").attr("data-reqtext");null!=n&&""!=n||(n="Please check at least one option before continuing");var i='<div class="alert alert-warning no-save" role="alert" style="padding:10px;margin:0px 5px">'+n+"</div>";return t.prepend(i),e=!1,!1}}),0!=e&&(t.find(".popdlg[data-type=merchandiseselection]").each(function(){var a=$(this);if(1==a.attr("data-reqd")&&0==a.find(".fm-mdse-items .selected").length){a.addClass("has-error");var n=a.find(".fieldname").attr("data-reqtext");null!=n&&""!=n||(n="Please make a selection before continuing");var i='<div class="alert alert-warning no-save" role="alert" style="padding:10px;margin:0px 5px">'+n+"</div>";return t.prepend(i),e=!1,!1}}),e))}function showStep(t,e,a){e=parseInt(e),t.find(".formstep li").removeClass("active"),t.find(".panelzone .formcontent").hide();var n=t.find(".formstep li[data-idx="+e+"]");n.addClass("active"),formEnsureVisible(n[0]);var i=t.find(".panelzone .formcontent[data-idx="+e+"]");i.show();var r,s=t.find("form");if((r=i.find(".fm-payment")).length){r.each(function(){fmRenderPaymentFields($(this).closest(".popdlg"))});var o=summarizeForm(s,i);r.attr("data-lz",o.lzData),r.attr("data-txtp",o.txtPrices)}(r=i.find(".fm-summary")).length&&r.each(function(){var t=$(this);t.html("Loading, please wait...");var e=t.closest(".formcontent"),a=summarizeForm(s,e);axpost("/pax/fmsummary","dt="+a.lzData+"&ep="+a.txtPrices,function(e){t.html(e)})}),msUpdateNavButtonStates(t,e),0==a&&partialSubmitCustomForm(t)}function formEnsureVisible(t){var e=t.getBoundingClientRect();e.bottom>window.innerHeight&&t.scrollIntoView(!1),e.top<0&&t.scrollIntoView({block:"center"})}function fmPriorStep(t){var e=t.find("li.active"),a=parseInt(e.attr("data-idx"));if(1!=a){var n=msPriorStepID(t,a);t.find("li[data-idx="+n+"]").length&&showStep(t,n,0)}}function fmNextStep(t){if(t.find(".btn-next").is(".final-step"))submitCustomForm(t);else if(validateCurrentStep(t)){var e=t.find("li.active"),a=msNextStepID(t,parseInt(e.attr("data-idx")));t.find("li[data-idx="+a+"]").length&&showStep(t,a,0)}}function msUpdateNavButtonStates(t,e){if(1==e){t.find(".btn-prev").hide();var a=msNextStepID(t,e),n=t.find(".btn-next");if(a>e){var i=t.find(".formstep li[data-idx="+a+"] .subtitle");n.text(i.text()+" >"),n.removeClass("final-step"),n.show()}else n.hide()}else{var r=msPriorStepID(t,e),s=t.find(".formstep li[data-idx="+r+"] .subtitle"),o=t.find(".btn-prev");if(o.text("< "+s.text()),o.show(),e==t.find(".formstep li").length){n=t.find(".btn-next");var d=t.attr("data-subbtntxt");""!=d&&null!=d||(d="Submit Information"),n.addClass("final-step"),n.text(d)}else{a=msNextStepID(t,e),n=t.find(".btn-next");if(a>e){i=t.find(".formstep li[data-idx="+a+"] .subtitle");n.text(i.text()+" >"),n.removeClass("final-step"),n.show()}else n.hide()}}}function msNextStepID(t,e){var a=t.find("ul.formstep li").length,n=e=parseInt(e);for(idx=e+1;idx<=a;idx++){if(0==t.find(".stepzone li[data-idx="+idx+"]").is(".msform-hidden")){n=idx;break}}return n}function msPriorStepID(t,e){var a=e=parseInt(e);for(idx=e-1;idx>=1;idx--){if(0==t.find(".stepzone li[data-idx="+idx+"]").is(".msform-hidden")){a=idx;break}}return a}function computeStepPath(t){var e=t.find("ul.formstep li").length,a=new Array;for(idx=1;idx<=e;idx++)a[idx]=0;var n=0;for(idx=1;idx<=e&&(a[idx]=1,nextPage=findNextPage(t,idx),0!=nextPage)&&(idx=nextPage,!(n>e+10));n++);var i=1;for(idx=1;idx<=e;idx++){var r=t.find(".stepzone li[data-idx="+idx+"]");if(1==a[idx]){r.removeClass("msform-hidden");var s=r.find("div.title"),o=s.text();o=o.replace(idx,i),s.text(o),i++}else r.addClass("msform-hidden")}var d=t.find("li.active");msUpdateNavButtonStates(t,d.attr("data-idx"))}function formPage(t){if(pageIndex=0,null!=msActiveForm){var e=msActiveForm.find("ul.formstep li").length;for(idx=1;idx<=e;idx++){var a=msActiveForm.find(".stepzone li[data-idx="+idx+"]");if(a.find(".subtitle").length&&a.find(".subtitle").text()==t){pageIndex=idx;break}}return pageIndex}}function formFieldValue(t){if(null!=msActiveForm){t=t.replace(/\s+/g,"-");var e="",a=msActiveForm.find("*[name="+t+"]");return 0==a.length?e:("radio"==a[0].type&&(a=msActiveForm.find("input[name="+t+"]:checked")),0==a.length?e:e=a.val())}}function findNextPage(fm,idx){var panel=fm.find(".panelzone .formcontent[data-idx="+idx+"]"),lzCode=panel.attr("data-stepcode");if(void 0===lzCode)return idx+1;var nextPage=0;code=LZString.decompressFromEncodedURIComponent(lzCode),msActiveForm=fm;var js="function evalNextPage(){"+code+"}; nextPage = evalNextPage();";return eval(js),void 0===nextPage?idx+1:nextPage}function partialSubmitCustomForm(t){var e=t.attr("id"),a=t.find("form"),n=a.clone();n.find("li.msform-hidden").each(function(){var t=$(this).attr("data-idx");n.find(".panelzone .formcontent[data-idx="+t+"]").remove()}),copyDataToClonedForm(a,n),addMerchandiseSelections(n);var i=n.serialize();axpost("/pax/customform",i+="&fmid="+e+"&ftype=partial",function(t){})}function submitCustomForm(t){var e=t.find(".fm-payment");e.length&&(outcome=processPaymentForm(t,e),0==outcome)||(t.find("li.msform-hidden").each(function(){var e=$(this).attr("data-idx");t.find(".panelzone .formcontent[data-idx="+e+"]").remove()}),t.find("form").submit())}function submitCustomFormAfterPayment(t,e){t.find("li.msform-hidden").each(function(){var e=$(this).attr("data-idx");t.find(".panelzone .formcontent[data-idx="+e+"]").remove()});var a=t.find("form .fm-payment"),n=a.attr("data-lz"),i=a.attr("data-txtp"),r=t.find("form");r.append('<input type="hidden" name="sumdata" value="'+n+'">'),r.append('<input type="hidden" name="pcdata" value="'+i+'">'),r.append('<input type="hidden" name="pmtid" value="'+e+'">'),r.submit()}function fmRenderPaymentFields(t){var e=new Array,a=t.find(".fm-payment");if(a.html("Loading, please wait..."),0==t.attr("data-amtsrc"))e.push(t.attr("data-ep"));else{var n=t.closest("form"),i=n.find(".formstep li").length;for(idx=1;idx<=i;idx++){if(!n.find(".stepzone li[data-idx="+idx+"]").is(".msform-hidden"))n.find(".panelzone .formcontent[data-idx="+idx+"]").find(".price").each(function(){var t=$(this);if(t.is(".selected")||t.is(":checked")||t.is(":selected"))e.push(t.attr("data-ep"));else if("number"==t.attr("type")){var a=parseInt(t.val());a>0&&e.push("[*"+a+"*]"+t.attr("data-ep"))}})}}var r=$.toJSON(e);axpost("/pax/fmpmtflds","dt="+LZString.compressToEncodedURIComponent(r),function(t){a.html(t)})}function fmPmtSetup(t,e,a){var n={base:{fontSize:"16px",lineHeight:"24px"}},i=($("#postalcode").attr("data-ov"),stripe.elements());cardNumber=i.create("cardNumber",{style:n}),cardNumber.mount("#cardnumber"),i.create("cardCvc",{style:n}).mount("#cvc"),i.create("cardExpiry",{style:n}).mount("#expiration"),i.create("postalCode",{style:n}).mount("#postalcode");parseInt($("#payment-request-button").attr("data-ot"));var r=$("#payment-request-button").attr("data-fh"),s=stripe.paymentRequest({country:a,currency:e,requestPayerName:!0,requestPayerEmail:!0,requestPayerPhone:!0,total:{label:r+" Payment",amount:t}}),o=i.create("paymentRequestButton",{paymentRequest:s}),d=$("#pmttrad").closest("form");s.canMakePayment().then(function(t){t?(o.mount("#payment-request-button"),$("#pmttrad").hide(),d.find(".btn-next").hide()):($("#payment-request-button").hide(),$("#pmttrad").show(),$("#hidetrad").hide(),$("#showtrad").hide())}),s.on("token",function(t){$("#payment-request-button").attr("data-tp");$("#pmtstatus").text("Processing payment - please wait..."),$("#pmtstatus").show();var e=$("#pmttrad");e.find("input[name=email]").val(t.payerEmail),e.find("input[name=telephone]").val(t.payerPhone),$("#pmttoken").val(t.token.id);var a=t.payerName.indexOf(" ");-1!=a&&($("#affirst").val(t.payerName.substring(0,a)),$("#aflast").val(t.payerName.substring(a+1))),void 0!==t.token.card&&($("#afstreet").val(t.token.card.address_line1),$("#afcity").val(t.token.card.address_city),$("#afstate").val(t.token.card.address_state),$("#zip").val(t.token.card.address_zip),$("#lastfour").val(t.token.card.last4),$("#expmonth").val(t.token.card.exp_month),$("#expyear").val(t.token.card.exp_year)),t.complete("success"),axpost("/pax/pmtctrsp",$("#payment-request-button").closest("form").serialize(),function(t){var e=JSON.parse(t);"OK"==e.result?submitCustomFormAfterPayment(d.closest(".inplace"),e.pmtid):($("#pmtstatus").html(e.html),$("#pmtstatus").show(),subBtn.prop("disabled",!1),$("#pmttoken").val(""))})}),$("#showtrad").click(function(){$("#payment-request-button").hide(),$("#pmttrad").show(),$("#showtrad").hide(),$("#hidetrad").show(),d.find(".btn-next").show()}),$("#hidetrad").click(function(){$("#payment-request-button").show(),$("#pmttrad").hide(),$("#showtrad").show(),$("#hidetrad").hide(),d.find(".btn-next").hide()})}function summarizeForm(t,e){var a=t.clone();if(null!=e){var n=e.attr("data-idx"),i=a.find(".stepzone li").length;for(n=n;n<=i;n++)a.find(".panelzone .formcontent[data-idx="+n+"]").remove()}a.find("li.msform-hidden").each(function(){var t=$(this).attr("data-idx");a.find(".panelzone .formcontent[data-idx="+t+"]").remove()}),copyDataToClonedForm(t.closest("form"),a),addMerchandiseSelections(a),itemPrices=new Array,a.find(".price").each(function(){var t=$(this),e={};if(t.is(".merchitem"))return!0;if(t.is(".selected")||t.is(":checked")||t.is(":selected"))if(e.ep=t.attr("data-ep"),t.is("option")){var a=t.closest("select");e.name=a.attr("name")}else e.name=t.attr("name");else{if("number"!=t.attr("type"))return!0;var n=parseInt(t.val());n>0&&(e.ep="[*"+n+"*]"+t.attr("data-ep"),e.name=t.attr("name"))}itemPrices.push(e)}),a.find(".auto-mrchfield").each(function(){var t=$(this),e={};e.ep=t.attr("data-ep"),e.name=t.attr("name"),itemPrices.push(e)});var r={},s=$.toJSON(itemPrices);r.txtPrices=LZString.compressToEncodedURIComponent(s);var o=a.serialize();return r.lzData=LZString.compressToEncodedURIComponent(o),r}function copyDataToClonedForm(t,e){e.find("select").each(function(){var e=$(this),a=t.find("select[name="+e.attr("name")+"]");e.val(a.val())})}function initFAPaymentForm(){window.addEventListener?window.addEventListener("message",processFAMessage,!1):window.attachEvent("onmessage",processFAMessage),$("#pc-mkchg").click(function(){axpost("/pax/pmtctrfs","amt="+$("#pcamt").attr("data-amt")+"&notes="+encodeURIComponent($("#pcnotes").html()),function(t){$("#paymentform").html(t)})}),$("#fafmpayment").submit(function(t){if(t.preventDefault(),""==$("#pmttoken").val())return $("#pmtstatus").text("Please complete the credit card details first"),void $("#pmtstatus").show();$("#pmtstatus").text("Processing payment - please wait..."),$("#pmtstatus").show();var e=$("#fafmpayment").serialize();return axpost("/pax/pmtctrsp","amt="+$("#pcamt").attr("data-amt")+"&notes="+encodeURIComponent($("#pcnotes").html())+"&"+e,function(t){var e=JSON.parse(t);"OK"==e.result?$("#paymentform").html(e.html):($("#pmtstatus").html(e.html),$("#pmtstatus").show())}),!1})}function initFAFormPayments(){window.addEventListener?window.addEventListener("message",processFAMessage,!1):window.attachEvent("onmessage",processFAMessage)}function processFAMessage(t){if(t.data.firstpay)switch(t.data.type){case"newCryptogram":$("#pmttoken").val(t.data.cryptogram),$("#pmtstatus").hide();break;case"cryptogramFailed":$("#pmttoken").val("")}}function initCustomForm(t){var e=$("#"+t),a=e.find("form"),n=pfx()+"/pax/customform";a.attr("action",n),e.find(".date-field").datetimepicker({pickTime:!1}),e.find("button[type=submit]").click(function(t){var a=validatePanel(e.find(".formcontent"));return 0==a&&t.preventDefault(),a}),fmInitializeDynamicItems(e),0==$("#site").is(".editmode")?initCustomFormSubmitHandler(e,a):a.find("button[type=submit]").click(function(t){return t.preventDefault(),alert("Form submissions are disabled on the admin side.  Test the form by visiting the public website (rather than the logged on side)."),!1})}function fmInitializeDynamicItems(t){var e=t.find(".fm-mdse-items");e.length&&e.each(function(){populateMerchandiseList($(this).closest(".popdlg"))})}function initCustomFormSubmitHandler(t,e){e.iframePostForm({post:function(){var a="";e.find(".popdlg[data-type=email]").each(function(){var t=$(this),e=t.find("input").attr("name"),n=1==t.attr("data-emactgs")?"gs":"",i=1==t.attr("data-emactoa")?"oa":"",r=1==t.attr("data-emactconf")?"conf":"",s=""!=r?t.attr("data-confmsg"):"",o=""!=r?t.attr("data-en"):"";""!=a&&(a+=","),a+=e+"|"+n+"|"+i+"|"+r+"|"+s+"|"+o}),""!=a&&e.prepend('<input type="hidden" name="paflags" value="'+a+'">');var n=new Array;if(e.find(".popdlg[data-summary=1]").each(function(){var t=$(this).find("input[type=text]");t.length&&n.push(t.attr("name"))}),n.length>0){var i=encodeURIComponent($.toJSON(n));e.prepend('<input type="hidden" name="cfssummaryfields" value="'+i+'">')}var r=t.find("input[name=confmsg]").attr("data-en");return void 0!==r&&e.prepend('<input type="hidden" name="confd" value="'+r+'">'),e.prepend('<input type="hidden" name="cfssb" value="833">'),addMerchandiseSelections(e),!0},complete:function(a){try{if(-1!=a.indexOf("PMT_ERROR")){var n=JSON.parse(a);$("#pmtstatus").text(n.html),$("#pmtstatus").show(),t.find(".btn-next").prop("disabled",!1),$("#pmttoken").val("")}else if(-1!=a.indexOf("CAPERROR")){axpost("/pax/captxt","dt="+(n=JSON.parse(a)).dt+"&un="+n.un,function(t){$(n.id).html(t)}),e.attr("pending",0)}else if("REDIRECT"==a){var i=window.location.pathname,r=i.lastIndexOf("/"),s=i.substr(0,r)+"/completed"+i.substr(r);window.location=s}else t.find(".cfsform").html(a)}catch(t){}return!1}})}function addMerchandiseSelections(t){t.find("input.auto-mrchfield").remove(),t.find("ul.merchandiselist").each(function(){var t=$(this),e=t.closest(".form-group"),a=htmlAttribute(e.find("label.fieldname").text());t.find("li.selected").each(function(){var t=$(this),n=t.find("div.title").text(),i=t.find("div.price"),r=i.attr("data-ep");i.length&&i.text();n=htmlAttribute(n),e.append('<input type="hidden" data-ep="'+r+'" class="auto-mrchfield" name="'+a+'" value="'+n+'">')})})}$(document).ready(function(){addPrefixToURLs(),$(document).delegate('*[data-toggle="lightbox"]',"click",function(t){return t.preventDefault(),$(this).ekkoLightbox({left_arrow_class:".glyphicon .glyphicon-chevron-left .white-text",right_arrow_class:".glyphicon .glyphicon-chevron-right .white-text"})}),window.sr=ScrollReveal(),sr.isSupported()&&(document.documentElement.classList.add("sr"),$(".lreveal").length&&sr.reveal(".lreveal",{origin:"left"}),$(".rreveal").length&&sr.reveal(".rreveal",{origin:"right"}),$(".treveal").length&&sr.reveal(".treveal",{origin:"top"}),$(".breveal").length&&sr.reveal(".breveal",{origin:"bottom"}))});var calBGColor="#fff";function initCalendar(t,e,a,n){$("#cal-"+t).fullCalendar({header:{left:"prev,next,today",center:"title",right:"month,agendaWeek,agendaDay,listWeek"},events:a+"/calendar/"+t,defaultView:n,eventColor:"#000",minTime:"08:00:00",maxTime:"22:00:00",eventBorderColor:"#808080",eventBackgroundColor:calBGColor,eventClick:function(a,n,i){var r=a.id.toString();return 0==e||-1!=r.indexOf("-")||(!$("#"+t).is(".edbyclk")||(editCalEvent(a.id,t),!1))},eventResize:function(t,e,a){var n="";n=t.end?t.end.format():t.start.format(),axpost("/pax/dgcalev","id="+t.id+"&st="+t.start.format()+"&ed="+n,function(t){})},eventDrop:function(t,e,a){var n="";n=t.end?t.end.format():t.start.format(),axpost("/pax/dgcalev","id="+t.id+"&st="+t.start.format()+"&ed="+n,function(t){})}}),$("#"+t+" .addcalev").click(function(){editCalEvent(0,t)}),$(".edbyclick").click(function(){$(this).is(":checked")?$("#"+t).addClass("edbyclk"):$("#"+t).removeClass("edbyclk")}),$("#"+t).is(".calservices")&&$("#cal-"+t).fullCalendar("addEventSource",a+"/calendar/services")}function editCalEvent(t,e){axpost("/pax/ecalev","id="+t+"&htmlid="+e,function(t){$("#admdyncnt").html(t)})}function axget(t,e,a){""!==spfx?$.get("/"+spfx+t,e,a):$.get(t,e,a)}function axpost(t,e,a,n){var i;n=void 0!==n&&n,i=""!==spfx?$.post("/"+spfx+t,e,a):$.post(t,e,a),n&&i.error(a)}function pfx(){return""!==spfx?"/"+spfx:""}function supports_h264_baseline_video(){return!!supports_video()&&""!=document.createElement("video").canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')}function supports_video(){return!!document.createElement("video").canPlayType}function initSiteSectionContents(t){var e=$("#"+t+" .smartzone"),a=$("#"+t);e.find(".selected").length?expandParentSidebarItem(e.find(".selected")):0==a.is(".always-show")&&e.hide()}function expandParentSidebarItem(t){var e=t.parent(),a=e.attr("id"),n=e.parent().find("p[data-target=#"+a+"]");n.length&&(n.click(),expandParentSidebarItem(n))}function navigateTo(t){"/"==t.charAt(0)&&""!==spfx&&(t="/"+spfx+t),window.location=t}function decodeValue(t){var e=decodeURIComponent(t);return e=e.replace(/\++/g," ")}function rsvpStringHash(t){var e=0;if(0==t.length)return e;for(i=0;i<t.length;i++)char=t.charCodeAt(i),e=(e<<5)-e+char,e&=e;return e}function initCarousel(t){var e=1e3*$("#"+t).attr("data-dur"),a=$("#"+t).attr("data-trans"),n=$("#"+t).attr("data-pause");$("#"+t+" .item").css("transition","opacity "+a+"s ease"),$("#"+t+" .item").css("-webkit-transition","opacity "+a+"s ease"),$("#"+t+" .item").css("-moz-transition","opacity "+a+"s ease"),$("#"+t+" .item").css("-ms-transition","opacity "+a+"s ease"),$("#"+t+" .item").css("-o-transition","opacity "+a+"s ease"),$("#"+t).carousel({interval:e,pause:n})}function readSitePrefix(){if(""!==spfx)return spfx;var t=window.location.href.split("/");if(t.length<4)return"";var e=t[3];return 3===e.length?e:""}function addPrefixToURLs(){var t=readSitePrefix();""===t?$('a[href^="/"]').each(function(){var t=$(this).attr("href");"/"==t.substring(0,1)&&"/"==t.substring(4,5)&&$(this).attr("href",t.substring(4))}):$('a[href^="/"]').each(function(){var e=$(this).attr("href");"/"+t+"/"!=e.substring(0,5)&&"//"!=e.substring(0,2)&&$(this).attr("href","/"+t+$(this).attr("href"))})}function addPrefixToURLsFrom(t){var e=readSitePrefix();""!=e&&t.find('a[href^="/"]').each(function(){var t=$(this).attr("href");"/"+e+"/"!=t.substring(0,5)&&"//"!=t.substring(0,2)&&$(this).attr("href","/"+e+$(this).attr("href"))})}function htmlAttribute(t){var e=t.replace(/\s+/g,"-");return e=e.replace(/[^a-zA-Z0-9-]/g,"")}function cleanAttribute(t){return newStr=t.replace(/[^a-zA-Z0-9-\s]/g,""),newStr}function initCSRAssignmentForm(){$("#insurancecompany").devbridgeAutocomplete({serviceUrl:pfx()+"/pax/inslookup",onSelect:function(t){$("#autoinsid").val(t.data),$("#autoinstext").val(t.value)}}),$("#csrassignment").submit(function(t){t.preventDefault(),0==$("#dob")[0].checkValidity()?$("#dob")[0].setCustomValidity("Please enter the birth date as mm/dd/yyyy"):$("#dob")[0].setCustomValidity(""),0==$("#dod")[0].checkValidity()?$("#dod")[0].setCustomValidity("Please enter the death date as mm/dd/yyyy"):$("#dod")[0].setCustomValidity("");var e=$("#amount").val();e=e.replace(/[^0-9\.]/g,"");var a=parseFloat(e);return isNaN(a)&&(a=0),a=a.toFixed(2),$("#amount").val(a),0==a?(alert("Please check your assignment dollar amount"),void $("#amount").focus()):(axpost("/pax/inscsrsub",$("#csrassignment").serialize(),function(t){var e=JSON.parse(t);"OK"==e.outcome?$("#cjcontent").html(e.message):($("#inserror").text(e.message),$("#inserror").show())}),!1)}),$("#gpolyes").click(function(){$("#employerdetails").show(),$("#employername").prop("required",!0),$("#employerphone").prop("required",!0)}),$("#gpolno").click(function(){$("#employerdetails").hide(),$("#employername").prop("required",!1),$("#employerphone").prop("required",!1)})}function initInlineSearch(t){$("#"+t).devbridgeAutocomplete({serviceUrl:pfx()+"/pax/oblkup",onSelect:function(t){if(""!=t.data){var e=pfx()+"/obituary/"+t.data;window.location=e}}})}function initObitAlertSignup(t){$("#"+t+" .suptype").length&&(setObitSubTypeRadios(t),$("#"+t+" .suptype").click(function(){setObitSubTypeRadios(t)})),$("#"+t).submit(function(){if(""==$("#"+t+" .email").val())return!1;if($("#"+t+" .suptype").length&&("all"!=$("#"+t+" .suptype:checked").val()&&0==$("#"+t+" .locsel:checked").length))return alert("Please select one or more locations first or check off 'all locations'"),!1;return axpost("/pax/omlsub",$("#"+t).serialize(),function(e){$("#"+t).parent().html(e)}),!1})}function setObitSubTypeRadios(t){"all"==$("#"+t+" .suptype:checked").val()?$("#"+t+" .locsel").prop("disabled",!0):$("#"+t+" .locsel").prop("disabled",!1)}function initGriefSignup(t){$("#"+t).submit(function(){return axpost("/pax/gssub",$("#"+t).serialize(),function(e){$("#"+t).parent().html(e)}),!1})}function initObitSearch(){$("#frmobitsrch").submit(function(){return axpost("/pax/obitsrch","pg=0&"+$(this).serialize(),function(t){$("#obitlist").html(t),fixupObitSeachURLs(),$("#monthstrip .obitsrchym").removeClass("btn-primary").addClass("btn-default"),$("#obsrchalpha .obsrchltr").removeClass("selected")}),!1}),$("#obsrchalpha .obsrchltr").click(function(){var t=$(this).attr("data-t");$("#obsrchalpha .obsrchltr").removeClass("selected"),$(this).addClass("selected"),axpost("/pax/obitsrch","pg=0&"+$("#frmobitsrch").serialize()+"&term="+t,function(t){$("#obitlist").html(t),fixupObitSeachURLs(),$("#monthstrip .obitsrchym").removeClass("btn-primary").addClass("btn-default")})})}function fixupObitSeachURLs(){var t=readSitePrefix();""!=t&&$('#obitlist a[href^="/"]').each(function(){$(this).attr("href","/"+t+$(this).attr("href"))})}function obitsrchmon(t){axpost("/pax/obitsrchmon","ym="+t,function(t){$("#monthstrip").html(t)})}function obitsrchSelMonth(t){axpost("/pax/obitsrch","ym="+t+"&"+$("#frmobitsrch").serialize(),function(t){$("#obitlist").html(t),fixupObitSeachURLs(),$("#obsrchalpha .obsrchltr").removeClass("selected")})}function initHzObitSet(){$(".hzset").length>0&&($(".hzset").click(function(){var t=$(this).closest(".smartzone");return t.fadeTo("normal",.5),axpost("/pax/hzobitset","stidx="+$(this).attr("data-idx")+"&num="+$(this).attr("data-num")+"&sids="+$(this).attr("data-sids")+"&lcity="+$(this).attr("data-lcity")+"&sets="+$(this).attr("data-sets")+"&smn="+$(this).attr("data-smn")+"&ps="+$(this).attr("data-ps")+"&sm="+$(this).attr("data-sm")+"&udn="+$(this).attr("data-udn")+"&udob="+$(this).attr("data-udob"),function(e){t.fadeTo("normal",1),t.html(e);var a=readSitePrefix();""!=a&&t.find('a[href^="/"]').each(function(){$(this).attr("href","/"+a+$(this).attr("href"))})}),!1}),$(".horizobits .listings").each(function(){if(1!=$(this).attr("data-swipe")){$(this).attr("data-swipe",1);var t=$(this)[0];Hammer(t).on("swipeleft",function(t){$(".hzobitnext a").click()}),Hammer(t).on("swiperight",function(){$(".hzobitprev a").click()})}}))}function initVtObitSet(){$(".vtset").length>0&&($(".vtset").click(function(){var t=$(this).closest(".smartzone");return t.fadeTo("normal",.5),axpost("/pax/vtobitset","stidx="+$(this).attr("data-idx")+"&num="+$(this).attr("data-num")+"&sids="+$(this).attr("data-sids")+"&lcity="+$(this).attr("data-lcity")+"&ph="+$(this).attr("data-ph")+"&sets="+$(this).attr("data-sets")+"&lm="+$(this).attr("data-lm")+"&smn="+$(this).attr("data-smn")+"&ps="+$(this).attr("data-ps")+"&nc="+$(this).attr("data-nc")+"&udn="+$(this).attr("data-udn")+"&udob="+$(this).attr("data-udob"),function(e){t.fadeTo("normal",1),t.html(e);var a=readSitePrefix();""!=a&&t.find('a[href^="/"]').each(function(){$(this).attr("href","/"+a+$(this).attr("href"))})}),!1}),$(".verticalobits .listings").each(function(){if(1!=$(this).attr("data-swipe")){$(this).attr("data-swipe",1);var t=$(this)[0],e=new Hammer(t);e.get("pan").set({direction:Hammer.DIRECTION_ALL}),e.on("swipeup",function(){$(".vtobitnext a").click()}),e.on("swipedown",function(){$(".vtobitprev a").click()})}}))}function initObitArchive(t){$("#"+t+" .oayear").click(function(){refreshObitArchive(t,$(this).attr("data-y"),$(this).attr("data-sids"),$(this).attr("data-dir"))})}function refreshObitArchive(t,e,a,n){axpost("/pax/obtarcv","y="+e+"&sids="+a+"&dir="+n,function(e){$("#"+t).html(e);var a=readSitePrefix();""!=a&&$("#"+t).find('a[href^="/"]').each(function(){$(this).attr("href","/"+a+$(this).attr("href"))}),initObitArchive(t)})}function initTestimonials(){$("#addtestimonial").click(function(){axpost("/pax/addtsml","",function(t){$("#dlgTestimonial").length&&$("#dlgTestimonial").remove(),$("#pubdyncnt").html(t)})})}function initTsmlRotator(t){$("#"+t+" .ts-back").click(function(){1==$("#"+t+" .ts-stop").is(":visible")&&$("#"+t+" .ts-stop").click(),rotateTsml(t,-1)}),$("#"+t+" .ts-stop").click(function(){var e=$("#"+t).attr("data-intid");clearInterval(e),$(this).hide(),$("#"+t+" .ts-play").show()}),$("#"+t+" .ts-play").click(function(){var e=setInterval(function(){rotateTsml(t,1)},1e4);$("#"+t).attr("data-intid",e),$(this).hide(),$("#"+t+" .ts-stop").show()}),$("#"+t+" .ts-forward").click(function(){1==$("#"+t+" .ts-stop").is(":visible")&&$("#"+t+" .ts-stop").click(),rotateTsml(t,1)}),$("#"+t+" .ts-play").click()}function reloadTestimonials(){var siteIDs="",ip=$("#testimonials").closest(".inplace").attr("id"),pndg=$("#testimonials").attr("data-pndg");siteIDs=ip?eval("cx"+ip).sources.toString():$("#testimonials").attr("data-sids"),axpost("/pax/listtsml","sids="+siteIDs+"&pndg="+pndg,function(t){$("#testimonials").html(t)})}function initTsmlForm(){$("#dlgTestimonial").modal("show"),$("#tsmldate").datetimepicker({todayBtn:"linked",pickTime:!1}),$("#fmtsml").formValidation({framework:"bootstrap",icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{tsmlname:{validators:{notEmpty:{message:"Please enter your name first"}}},tsmltext:{validators:{notEmpty:{message:"Please enter your testimonial"}}}}}),$("#dlgTestimonial .cmdclose").click(function(){($("#fmtsml").data("formValidation").validate(),$("#fmtsml").data("formValidation").isValid())&&axpost("/pax/doaddtsml",$("#fmtsml").serialize(),function(t){if("OK"==t){$("#dlgTestimonial").modal("hide");var e=$("#testimonials").closest(".inplace").find(".inplace p.text-center");e&&e.html('<span class="label label-default label-cfs">Thank you.  We appreciate you taking the time to give us your feedback</span>')}else"Refresh"==t?($("#dlgTestimonial").modal("hide"),reloadTestimonials()):$("#tsmlstatus").html(t)})})}function rotateTsml(htmlID,dir){var items=eval("tsd"+htmlID),cur=parseInt($("#"+htmlID).find(".tsmlitem").attr("data-cur"));cur+=parseInt(dir),cur<0&&(cur=items.length-1),cur>=items.length&&(cur=0);var item=items[cur];$("#"+htmlID).find(".tsmlslider").fadeTo("normal",.5,function(){var t=$("#"+htmlID);t.find(".tmtext").html(item.text),t.find(".tmname").html(item.name),t.find(".tmdate").html(item.date),t.find(".tsmlitem").attr("data-cur",cur),t.find(".tsmlslider").fadeTo("normal",1)})}function initBlog(t){axpost("/pax/blcal","id="+t,function(e){$("#"+t+" .postcal").html(e),initCalendar(t)})}function initBlogCalendar(t){$("#"+t+" .selyr").click(function(){axpost("/pax/blcal","id="+t+"&y="+$(this).attr("data-yr")+"&ym="+$(this).attr("data-ym"),function(e){$("#"+t+" .postcal").html(e)})}),$("#"+t+" .month-active").click(function(){axpost("/pax/blcal","id="+t+"&ym="+$(this).attr("data-ym"),function(e){$("#"+t+" .postcal").html(e)}),axpost("/pax/blart","id="+t+"&ym="+$(this).attr("data-ym"),function(e){$("#"+t+" .smartzone").html(e)})})}function initBlogPage(){function t(){var t=document.getElementById("search-posts-input");if(0==t.value.length)var a="data=&search=";else{if(3>t.value.length)return!1;a="data=&search="+t.value}axpost("/pax/getpage",a,function(t){$("#blogContent").html(t),e()}),t.value=""}function e(){var e=document.getElementById("clrSearch");e&&e.addEventListener("click",function(){document.getElementById("search-posts-input").value="",t()},!1)}$(".nPage").on("click",function(){axpost("/pax/getpage","data="+$(this).attr("data-id")+"&search="+$(this).attr("data-search"),function(t){$("#blogContent").html(t),e()})}),$("#add-text").on("click",function(){var t=$("#addText").val();if(console.log(t),""!=t){t=LZString.compressToEncodedURIComponent(t),console.log(t);var a="data=&addtext="+t;confirm("Are you sure you want to add this text to the end of every blog post?")&&axpost("/pax/getpage",a,function(t){$("#blogContent").html(t),alert("Text saved successfully"),e()})}else alert("The field cant be left empty. Please enter some text and try again")}),document.getElementById("search-posts").addEventListener("click",t,!1),document.getElementById("search-posts-input").addEventListener("focus",function(e){e.target.addEventListener("keydown",function(e){13===e.keyCode&&t()},!1)},!1)}function initEvents(t){axpost("/pax/evcal","id="+t,function(e){$("#"+t+" .postcal").html(e),initCalendar(t)})}function initEventsCalendar(t){$("#"+t+" .selyr").click(function(){axpost("/pax/evcal","id="+t+"&y="+$(this).attr("data-yr")+"&ym="+$(this).attr("data-ym"),function(e){$("#"+t+" .postcal").html(e)})}),$("#"+t+" .month-active").click(function(){axpost("/pax/evcal","id="+t+"&ym="+$(this).attr("data-ym"),function(e){$("#"+t+" .postcal").html(e)}),axpost("/pax/evart","id="+t+"&ym="+$(this).attr("data-ym"),function(e){$("#"+t+" .smartzone").html(e)})})}function updateClock(t){var e=new Date,a=new Array;a[a.length]="January",a[a.length]="February",a[a.length]="March",a[a.length]="April",a[a.length]="May",a[a.length]="June",a[a.length]="July",a[a.length]="August",a[a.length]="September",a[a.length]="October",a[a.length]="November",a[a.length]="December";var n=new Array;n[n.length]="Sunday",n[n.length]="Monday",n[n.length]="Tuesday",n[n.length]="Wednesday",n[n.length]="Thursday",n[n.length]="Friday",n[n.length]="Saturday";var i=e.getHours(),r=e.getMinutes(),s=e.getSeconds(),o=i<12?"AM":"PM",d=(i=0==(i=i>12?i-12:i)?12:i)+":"+(r=(r<10?"0":"")+r)+":"+(s=(s<10?"0":"")+s)+" "+o;d=n[e.getDay()]+", "+a[e.getMonth()]+" "+e.getDate()+"  "+e.getFullYear()+"<br />"+d,$("#"+t).html(d)}function initGalleryWidget(t){1!=$("#"+t).attr("data-nosort")&&$("#"+t).imagesLoaded(function(){$("#"+t+" .gallery").masonry({columnWidth:".ogpitem",itemSelector:".ogpitem"})})}function initMultiMap(t,e,a,n,i,r,s,o){var d={path:"M0-48c-9.8 0-17.7 7.8-17.7 17.4 0 15.5 17.7 30.6 17.7 30.6s17.7-15.4 17.7-30.6c0-9.6-7.9-17.4-17.7-17.4z",strokeColor:s,scale:.6,fillOpacity:1,fillColor:s},l={path:"M0-48c-9.8 0-17.7 7.8-17.7 17.4 0 15.5 17.7 30.6 17.7 30.6s17.7-15.4 17.7-30.6c0-9.6-7.9-17.4-17.7-17.4z",strokeColor:o,scale:.6,fillOpacity:1,fillColor:o},c=new google.maps.Map(document.getElementById(t),{zoom:12,center:r,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,zoomControl:!0,disableDoubleClickZoom:!0,draggable:!0,scrollwheel:!1,styles:n});if(a.length>1){var m=new google.maps.LatLngBounds;m.extend(i),m.extend(r),c.fitBounds(m)}var p,u,f=new google.maps.InfoWindow,h=new Array,v=0;for(u=0;u<a.length;u++)p=new google.maps.Marker({position:new google.maps.LatLng(a[u][1],a[u][2]),icon:l,map:c}),v=a[u][3],a[u][0],p.locID=v,h.push(p),google.maps.event.addListener(p,"click",function(t,n){return function(){if(""!=e){setTimeout(function(){$("#"+e).trigger("to.owl.carousel",[n,250,!0])},500),multimapTileClick($("#mmloc"+a[n][3]),c,m,e,h,d,l)}else{url=a[n][4];var i="<h4>"+a[n][0]+'</h4><div class="text-center"><a href="'+url+'" target="_blank"><button class="btn btn-sm btn-default">Directions</button></a></div>';f.setContent(i),f.open(c,t)}}}(p,u));google.maps.event.addDomListener(window,"resize",function(){google.maps.event.trigger(c,"resize"),a.length>1?c.fitBounds(m):c.setCenter(r)}),""!=e&&$("#"+e+" .multimap-location").click(function(){multimapTileClick($(this),c,m,e,h,d,l)})}function multimapTileClick(t,e,a,n,i,r,s){var o=0,d=t.attr("data-locid");if(t.is(".selected"))for(t.removeClass("selected"),e.fitBounds(a),o=0;o<i.length;o++)i[o].setIcon(s),i[o].setVisible(!0);else{var l=null;for(o=0;o<i.length;o++)i[o].setVisible(!0),d==i[o].locID&&(l=i[o]);for(o=0;o<i.length;o++)d==i[o].locID?i[o].setIcon(r):(i[o].getPosition().toString()==l.getPosition().toString()&&i[o].setVisible(!1),i[o].setIcon(s));$("#"+n+" .multimap-location").removeClass("selected"),t.addClass("selected");var c=new google.maps.LatLng(t.attr("data-lat"),t.attr("data-lng"));e.setCenter(c),e.setZoom(12)}}function initMultiMapOSM(t,e,a,n,r,s,o,d,l){var c=L.map(t,{scrollWheelZoom:!1,zoomControl:!1}).setView([41.505,-70],13);L.tileLayer("https://www.cfsbase.com/cfs/{z}/{x}/{y}.png/"+l,{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(c);new L.Control.Zoom({position:"topright"}).addTo(c);var m=L.icon({iconUrl:"/tools/leaflet/images/CFS/unselected3_marker-icon.png",iconSize:[25,41],iconAnchor:[13,41]}),p=new Array,u=""!=e?.9:1;for(i=0;i<a.length;i++){var f=L.marker([a[i][1],a[i][2]],{opacity:u,icon:m});if(f.ip=t,f.clat=a[i][1],f.clng=a[i][2],f.locStripID=e,f.locID=a[i][3],f.addTo(c),""==e){var h=a[i][4],v="<h4>"+a[i][0]+'</h4><div class="text-center"><a href="'+h+'" target="_blank"><button class="btn btn-sm btn-default">Directions</button></a></div>';f.bindPopup(v)}else f.on("click",onOSMMarker);p.push(f)}multiMaps[t]=p,p.length>1?c.fitBounds([r,s]):c.setView([p[0].clat,p[0].clng],13),""!=e&&$("#"+e+" .multimap-location").click(function(){multimapTileClickOSM($(this),e,c,r,s,t)})}function multimapTileClickOSM(t,e,a,n,i,r){var s=0,o=t.attr("data-locid"),d=multiMaps[r],l=L.icon({iconUrl:"/tools/leaflet/images/CFS/unselected3_marker-icon.png",iconSize:[25,41],iconAnchor:[13,41]});if(t.is(".selected")){for(s=0;s<d.length;s++)d[s].setIcon(l),d[s].setOpacity(.9);return t.removeClass("selected"),void(d.length>1?a.fitBounds([n,i]):a.setView([d[0].clat,d[0].clng],13))}var c=L.icon({iconUrl:"/tools/leaflet/images/CFS/selected3_marker-icon.png",iconSize:[25,41],iconAnchor:[13,41]}),m=null;for(s=0;s<d.length;s++)o==d[s].locID&&(m=d[s]);m&&(m.setOpacity(1),m.setIcon(c)),$("#"+e+" .multimap-location").removeClass("selected"),t.addClass("selected"),a.setView([t.attr("data-lat"),t.attr("data-lng")],13)}function onOSMMarker(t){var e=t.sourceTarget;""!=e.locStripID&&$("#mmloc"+e.locID).click()}function analytics(t,e){if(1!=analyticsCheckout||-1==e.indexOf("Checkout"))try{"Checkout"!=e&&"CheckoutSC"!=e||(analyticsCheckout=1);var a=trackerCount>1?"track"+trackerCount+".send":"send";ga(a,{hitType:"event",eventCategory:t,eventAction:e,eventLabel:"CFS"})}catch(t){}}function initMerchandise(t){$("#"+t+" .curline").click(function(){var e=$(this).attr("data-id"),a=$("#"+t+" .curline").length;axpost("/pax/store","rid="+t+"&cid=0&lid="+e+"&oid=0&nl="+a,function(e){$("#"+t).html(e)})})}function initCompactStore(t){$("#"+t+" .clickcat").click(function(){var e=$(this).attr("data-lid"),a=$(this).attr("data-cid");axpost("/pax/cstore","hid="+t+"&lid="+e+"&cid="+a,function(e){$("#"+t+" .sitestore").html(e)})}),$("#"+t+" .linesel").click(function(){var e=$(this).attr("data-lid");axpost("/pax/cstore","hid="+t+"&lid="+e,function(e){$("#"+t+" .sitestore").html(e)})})}function initCStoreProducts(t){$("#"+t+" .cstore-arrow").click(function(){csSelectProduct(t,$(this))})}function initCStoreProductStrip(t){$("#"+t+" .prodsel").click(function(){csSelectProduct(t,$(this))}),$("#"+t+" .page-arrow").click(function(){var e=$(this).attr("data-lid"),a=$(this).attr("data-cid"),n=$("#"+t+" .dispprod").attr("data-pid"),i=$(this).attr("data-pg");axpost("/pax/cstorepage","hid="+t+"&lid="+e+"&cid="+a+"&pid="+n+"&pg="+i,function(e){$("#"+t+" .prodstrip").html(e)})})}function csSelectProduct(t,e){var a=e.attr("data-lid"),n=e.attr("data-cid"),i=e.attr("data-pid");axpost("/pax/cstoreprods","hid="+t+"&lid="+a+"&cid="+n+"&pid="+i,function(e){$("#"+t+" .prodview").html(e)})}function consumerCheckLogon(t){return ccsecProcFn=t,axpost("/ajax/axsecurity.php","act=ccsec",function(t){"OK"==t?ccsecProceed():$("#pubdyncnt").html(t)}),!1}function ccsecProceed(){ccsecProcFn&&(ccsecProcFn(),ccsecProcFn=null)}function formatMoney(e){return c=2,d=".",t=",",s=e<0?"-":"",i=String(parseInt(e=Math.abs(Number(e)||0).toFixed(c))),j=(j=i.length)>3?j%3:0,s+(j?i.substr(0,j)+t:"")+i.substr(j).replace(/(\d{3})(?=\d)/g,"$1"+t)+(c?d+Math.abs(e-i).toFixed(c).slice(2):"")}function policyDlg(t){axpost("/pax/policydlg","tp="+t,function(t){$("#pubdyncnt2").html(t)})}function initPopout(t){var e=$("#"+t);$("#trailinghtml").append(e),$("#"+t+" .po-close").click(function(){e.hide(),axpost("/svax/s/"+t,"",function(t){})}),axpost("/svax/g/"+t,"",function(t){0==t&&e.show()})}String.prototype.hashCode=function(){var t,e,a=0;if(0==this.length)return a;for(t=0,e=this.length;t<e;t++)a=(a<<5)-a+this.charCodeAt(t),a&=4294967295;return a},ccsecProcFn=null,jQuery.cfsCheckLoaded=function(t,e,a){"undefined"!=t?a():$.getScript(e,function(){a()})};