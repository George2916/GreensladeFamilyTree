var v3rid="prodinfozone";function initStoreZone(){}function initProductListPage(){attachFilterEvents(),$.appear("#prodgrid div.invprodimg",{interval:2e3,force_process:!0}),$("#prodgrid div.invlink").click(function(t){var e=$(this).find("div.invprodimg");if(e.length){var a={event:"productClick",ecommerce:{}};a.ecommerce.currencyCode=e.attr("data-cur"),a.ecommerce.click={},a.ecommerce.click.actionField={list:"Product List Page"},a.ecommerce.click.products=[];var i={};i.name=decodeURIComponent(e.attr("data-nm")),i.id=e.attr("data-id"),i.price=e.attr("data-pr"),i.brand=e.attr("data-lid"),i.category=catIDs[e.attr("data-cid")],i.position=parseInt(e.attr("data-pos")),document.cookie="selectedProdPos="+parseInt(e.attr("data-pos"))+";path=/",i.dimension40="CFS",i.dimension44=$("#obstore31").attr("data-tm"),i.dimension45=$("#obstore31").attr("data-tn"),i.dimension49=$("#obstore31").attr("data-tsn"),a.ecommerce.click.products.push(i),window.dataLayer.push(a)}var r=window.location.href+"/"+$(this).attr("data-href");return r=(r=r.replace("/sympathy","")).replace("/send-flowers",""),window.location=r,!0}),$("#prodgrid div.invprodimg").on("appear",function(t,e){var a=[],i=$("#obstore31").attr("data-tm"),r=$("#obstore31").attr("data-tn"),n=$("#obstore31").attr("data-tsn"),s="";if(e.each(function(){if(!1===$(this).is(".inview")){var t={};t.name=decodeURIComponent($(this).attr("data-nm")),t.id=$(this).attr("data-id"),t.price=$(this).attr("data-pr"),t.brand=$(this).attr("data-lid"),t.category=catIDs[$(this).attr("data-cid")],t.list="Product List Page",t.position=parseInt($(this).attr("data-pos")),t.dimension40="CFS",t.dimension44=i,t.dimension45=r,t.dimension49=n,s=$(this).attr("data-cur"),a.push(t),$(this).addClass("inview")}}),a.length){var o={event:"productListView",ecommerce:{}};o.ecommerce.currencyCode=s,o.ecommerce.impressions=a,window.dataLayer.push(o)}})}function initProdPage(){var t=$("#prodpg31 .pricepoint.selected");t.length&&onSelectProduct(t),$("#prodpg31 .pricepoint").click(function(){$("#prodpg31 .pricepoint").removeClass("selected"),$(this).addClass("selected"),onSelectProduct($(this))}),$("#treeoptgp").length&&($("#treeoptgp div.tree-qty").click(function(){$("#treeoptgp div.tree-qty").removeClass("selected"),$(this).addClass("selected")}),setTimeout(function(){$("#treeoptgp div.tree-qty").removeClass("selected");var t=$("#treeoptgp input[name=obpid]:checked");t.length&&t.closest("div.tree-qty").addClass("selected")},1e3));var e=$("#prodpg31 .prodtip"),a=e.attr("data-nr"),i=e.attr("data-nrp"),r=e.attr("data-p"),n=e.attr("data-no"),s='<div class="treetitle">Show your support for '+a+" by planting a memorial tree</div>",o='<div class="pad-top">A beautiful memorial tree will be planted in memory of '+a+". This will be done in partnership with our planting partner, the "+r+". Each memorial tree includes a certificate that can be sent to the recipient of your choosing to demonstrate the gift that you have given. Your name will also be listed on "+i+" Tribute Wall.</div>";n>0&&(o='<div class="treesordered"><img style="height:19px;" src="https://cfsdirect.s3.amazonaws.com/stock/tree-icon.png" alt="Memorial Tree Icon"> <strong>'+(n>1?n+" trees":"One tree has been")+" planted in memory of "+a+"</strong></div>"+o);e.popover({html:!0,placement:"top",trigger:"hover",title:s,content:o}),$("#prodnavtabs .navcell31").click(function(){var t=$(this).attr("data-tab");$("#prodnavtabs .navcell31").removeClass("nav-selected"),$(this).addClass("nav-selected"),$("#prodnavpanels .prod-nav-content").hide(),$("#"+t).show()}),$("#deliverytarget").change(function(){onDeliveryTargetChange()}),onDeliveryTargetChange()}function onSelectProduct(t){$("#prodprice").text("$"+t.attr("data-p")),$("#obpid").val(t.attr("data-pid"))}function onDeliveryTargetChange(){var t=$("#deliverytarget option:selected");$("#delnar").text(" "+t.attr("data-n")),$("#delftr").text(" "+t.attr("data-n"))}function initOrderSummaryTooltips(){if($("#scinfo").tooltip(),$("#mtinfo").length){var t=$("#mtinfo");t.popover({html:!0,placement:"auto",trigger:"hover",title:t.attr("data-title"),content:t.attr("data-txt")})}}function initCardMsgPanel(){previewCardMsg(),$("#pmtwopts").length&&$("#pmtwopts div.ptwopt").click(function(){$("#pmtwopts div.ptwopt").removeClass("selected"),$(this).addClass("selected")}),setInterval(previewCardMsg,200),$("#msgs").change(function(){$("#cardmsg").val($(this).val()),$(this).val(""),previewCardMsg()}),$("#submsg").click(function(){submitCardMsg()})}function previewCardMsg(){if(0!=$("#cardmsg").length){var t=$("#cardmsg").val().trim(),e=($("#signature").val().trim(),$("#msglen")),a=$("#msglen").attr("data-mx"),i=a-t.length;if(i<0){var r=t.substr(0,a);$("#cardmsg").val(r),t=r,i=0}t=t.replace(/(?:\r\n|\r|\n)/g,"<br>"),e.text(i),200!=parseInt(i)&&$("#msgstatus").hide(),200==parseInt(i)&&$("#msgstatus").show(),i<20?$("#msglen-warning").addClass("warning"):$("#msglen-warning").removeClass("warning")}else $("#msgs").val("")}function submitCardMsg(){if(""==$("#cardmsg").val().trim()&&1!=$("#submsg").attr("data-conf")){return $("#msgstatus").text("You have not entered a card message.  If you do not wish to provide one, click on the 'Continue' button once more"),void $("#submsg").attr("data-conf",1)}var t=0;$("#pmtwopts").length&&(t=$("#pmtwopts div.ptwopt.selected").attr("data-id"));var e=$("#cardmsg").val().replace(/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g,""),a=LZString.compressToEncodedURIComponent(e),i=LZString.compressToEncodedURIComponent($("#signature").val()),r=$("#puboptions input[name=pubopt]:checked").val(),n=$("#submsg").attr("data-sid");axpost("/pax/ckoutnos","st=domsg&cm="+a+"&sig="+i+"&sn="+n+"&po="+r+"&ptw="+t,function(t){$("#checkout31").html(t)})}function onBypassCardMsg(){$("#cardmsg").val(""),$("#signature").val(""),$("#submsg").attr("data-conf",1),dataLayer.push({event:"gaEvent",category:"Checkout",action:"Navigation",label:"Skip Message"}),submitCardMsg()}function initDeliveryPanel(){updateDeliverySummary(),$("#delivery").change(function(){updateDeliverySummary()}),$("#subdel").click(function(){submitDelivery()})}function updateDeliverySummary(){var t=$("#delivery option:selected");if($("#handdeltext").length){var e=t.attr("data-p")+"hand deliver your arrangement"+t.attr("data-n");$("#handdeltext").text(e)}var a="",i=t.attr("data-s"),r=parseInt($("#delivery").val()),n=!1;switch(r){case 0:a="",n=!0;break;case 2:a="<label>Your item will be delivered to: </label><br><em>"+i+"</em>",n=!0;break;default:a="<label>Your item will be delivered in time for the: </label><br><em>"+i+"</em>",n=!1}n?$("#earliestdelivery").show():$("#earliestdelivery").hide(),$("#deliverysummary").html(a),0==r?($("#delsumzone").hide(),$("#deladdress").show()):($("#delsumzone").show(),$("#deladdress").hide())}function submitDelivery(){if(0==$("#delivery").val()&&0==validateForm($("#addrform")))return;var t="st=dodel&"+deliveryData()+"&sn="+$("#subdel").attr("data-sid");axpost("/pax/ckoutnos",t,function(t){$("#checkout31").html(t)})}function validateForm(t){var e=!0;t.find("div.has-error").removeClass("has-error"),t.find("div.cfs-check").remove();var a=t.find("input,textarea,select").filter("[required]"),i=!0;if(a.each(function(){var a=$(this),r="";if(i=!0,0==a[0].checkValidity())r="Please provide a response in the highlighted (red) area below",i=!1;else if(null!=a.attr("data-type")){switch(a.attr("data-type")){case"email":var n=a.val().trim();0==/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(n)&&(r="Please ensure that you typed a valid email address",i=!1);break;case"telephone":var s=a.val();((s=s.replace(/\D/g,"")).length<9||0==/^(?:(1\-?)|(\+1 ?))?\(?(\d{3})[\)\-\.]?(\d{3})[\-\.]?(\d{4})$/.test(s))&&(r="Please ensure that you entered a valid telephone number",i=!1)}}if(0==i){a.closest("div").addClass("has-error");var o='<div class="alert alert-warning cfs-check" role="alert" style="padding:10px;margin:0px 5px">'+r+"</div>";return t.prepend(o),a.focus(),e=!1,!1}}),0==e)return!1}function delBack(){var t="st=delback&"+deliveryData()+"&sn="+$("#subdel").attr("data-sid");axpost("/pax/ckoutnos",t,function(t){$("#checkout31").html(t)})}function deliveryData(){var t=$("#addrform").serialize();return t+="&delid="+$("#delivery").val()}var cardNumber=null,stripe=null;function initPaymentPanel(){$("#custeml").blur(function(){updateCustInfo()}),$("#subpay").click(function(){submitPayment()});var t={base:{fontSize:"16px",lineHeight:"24px"}};$("#pmtform").submit(function(t){return t.preventDefault(),!1});var e=$("#subpay").attr("data-pk");stripe=Stripe(e);$("#postalcode").attr("data-ov");var a=stripe.elements();(cardNumber=a.create("cardNumber",{style:t})).mount("#cardnumber"),a.create("cardCvc",{style:t}).mount("#cvc"),a.create("cardExpiry",{style:t}).mount("#expiration");var i=a.create("postalCode",{style:t});i.mount("#postalcode");var r=$("#postalcode").attr("data-ov");""!=r&&i.update({value:r})}function updateCustInfo(){var t=$("#custeml").val(),e=$("#subpay").attr("data-sid");axpost("/pax/ckoutnos","st=upcmem&sn="+e+"&em="+t,function(t){})}function submitPayment(){0!=validateForm($("#pmtform"))&&stripe.createToken(cardNumber).then(function(t){t.error?($("#pmtstatus").text(t.error.message),$("#pmtstatus").show(),$("#pmttoken").val("")):($("#pmttoken").val(t.token.id),$("#expmonth").val(t.token.card.exp_month),$("#expyear").val(t.token.card.exp_year),$("#lastfour").val(t.token.card.last4),$("#zip").val(t.token.card.address_zip),payAction("dopay"))})}function payBack(){payAction("payback")}function payAction(t){var e="st="+t+"&"+paymentData()+"&ab="+$("#subpay").attr("data-ab")+"&sn="+$("#subpay").attr("data-sid");axpost("/pax/ckoutnos",e,function(t){$("#checkout31").html(t)})}function paymentData(){return $("#pmtform").serialize()}function initConfirmOrderPage(){$("#placeorder").click(function(){$("#placeorder").hide(),$("#ordplwait").show();var t=$("#placeorder").attr("data-sid");axpost("/pax/ckoutnos","st=doconf&sn="+t,function(t){$("#ordplwait").hide(),$("#placeorder").show(),$("#checkout31").html(t)})})}function removeTree(t,e){confirm("Are you sure that you want to remove the memorial tree option from your order?")&&axpost("/pax/ckoutnos","st=rmtree&sn="+e+"&finst="+t,function(e){1==t?$("#checkout31").html(e):$("#chgsum").html(e)})}function ckstep(t,e){axpost("/pax/ckoutnos","st="+t+"&sn="+e,function(t){$("#checkout31").html(t)})}function initStoreInventory(){$("#invfilters input[name=invpftr]").click(function(){var t=$(this).val();if($("#xsfilters .xspfltr").removeClass("selected"),$(this).is(":checked")&&$("#xsfilters .xspfltr[data-id="+t+"]").addClass("selected"),0==t&&$(this).is(":checked")?$("#invfilters input[name=invpftr]").not($(this)).prop("checked",!1):$("#invfilters input[name=invpftr]:first").prop("checked",!1),0==$("#invfilters input[name=invpftr]:checked").length&&($("#invfilters input[name=invpftr]:first").prop("checked","true"),$("#xsfilters .xspfltr[data-id=0]").addClass("selected")),0==$("#xsfilters .xspfltr.selected").length){var e=$("#invfilters input[name=invpftr]:checked:first");$("#xsfilters .xspfltr[data-id="+e.val()+"]").addClass("selected")}applyFilters(!0)}),$("#xsfilters .xspfltr").click(function(){var t=$(this).attr("data-id");$("#xsfilters .xspfltr").removeClass("selected"),$("#invfilters input[name=invpftr]").prop("checked",!1),$(this).addClass("selected"),$("#invfilters input[name=invpftr][value="+t+"]").prop("checked",!0),applyFilters(!0)}),$("#invfilters input[name=invcftr]").click(function(){var t=$(this).val();0==t&&$(this).is(":checked")?$("#invfilters input[name=invcftr]").not($(this)).prop("checked",!1):$("#invfilters input[name=invcftr]:first").prop("checked",!1),0==$("#invfilters input[name=invcftr]:checked").length&&$("#invfilters input[name=invcftr]:first").prop("checked","true"),$.each($("#invfilters input[name=invcftr]"),function(){t=$(this).val(),$("#xsfilters input[name=invcftr][value="+t+"]").prop("checked",$(this).prop("checked"))}),applyFilters(!0)}),$("#xsfilters input[name=invcftr]").click(function(){var t=$(this).val();0==t&&$(this).is(":checked")?$("#xsfilters input[name=invcftr]").not($(this)).prop("checked",!1):$("#xsfilters input[name=invcftr]:first").prop("checked",!1),0==$("#xsfilters input[name=invcftr]:checked").length&&$("#xsfilters input[name=invcftr]:first").prop("checked","true"),$.each($("#xsfilters input[name=invcftr]"),function(){t=$(this).val(),$("#invfilters input[name=invcftr][value="+t+"]").prop("checked",$(this).prop("checked"))}),applyFilters(!0)}),0==$("#invfilters input[name=invcftr]:checked").length&&$("#invfilters input[name=invcftr]:first").prop("checked","true"),0==$("#invfilters input[name=invpftr]:checked").length&&$("#invfilters input[name=invpftr]:first").prop("checked","true"),applyFilters(!1)}function applyFilters(t){var e=$("#invfilters input[name=invpftr]:first"),a=$("#invfilters input[name=invcftr]:first"),i="";if($("#invnomatch").hide(),e.is(":checked")&&a.is(":checked"))return $("#inventoryzone .inv-cell").show(),void axpost("/pax/invflr","st=p0,c0",function(){});$("#inventoryzone .inv-cell").hide(),$("#inventoryzone .inv-cell").attr("data-sh",0),a.is(":checked")?($("#inventoryzone .inv-cell").attr("data-sh",1),i+=",c0"):$.each($("#invfilters input[name=invcftr]:checked"),function(){var t=$(this).val();$("#inventoryzone .inv-cell[data-cfid="+t+"]").attr("data-sh",1),i+=",c"+t});var r=$("#inventoryzone .inv-cell[data-sh=1]");e.is(":checked")?(r.show(),i+=",p0"):$.each($("#invfilters input[name=invpftr]:checked"),function(){var t=$(this).val();$("#inventoryzone .inv-cell[data-sh=1][data-pfid="+t+"]").show(),i+=",p"+t}),0==$("#inventoryzone .inv-cell:visible").length&&0==e.is(":checked")&&$("#invnomatch").show(),axpost("/pax/invflr","st="+i,function(){})}function attachFilterEvents(){$("#invfilters input:checkbox").change(function(){if(this.checked){if(void 0===$(this).parent())return;let t=$(this).parent().text().trim(),e="All"!=t?"":"invcftr"===$(this).attr("name")?"Type ":"Price ";console.log(e+t),dataLayer.push({event:"gaEvent",category:"Store",action:"Filter Click",label:e+t})}})}function editMsg(){var t="st=editmsg&"+deliveryData()+"&sn="+$("button[data-sid]").attr("data-sid");dataLayer.push({event:"gaEvent",category:"Checkout",action:"Navigation",label:"Optional: Add a Card Message"}),axpost("/pax/ckoutnos",t,function(t){$("#checkout31").html(t)})}